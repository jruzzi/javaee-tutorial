type=page
status=published
title=Specifying an Endpoint Configurator Class
~~~~~~
Specifying an Endpoint Configurator Class
=========================================
2017-07-17T15:27:49Z

[[top]]

[width="100%",cols="50%,45%,^5%",]
|=======================================================================
|*Java Platform, Enterprise Edition The Java EE Tutorial* +
*Release 8 Java Platform, Enterprise Edition* +
E63026-01
|
|link:toc.html[image:img/toc.gif[Go To Table Of
Contents] +
Contents]
|=======================================================================

'''''

[cols="^5%,^5%,90%",]
|=======================================================================
|link:websocket009.html[image:img/leftnav.gif[Previous] +
Previous] 
|link:websocket011.html[image:img/rightnav.gif[Next] +
Next] | 
|=======================================================================


[[BABJAIGH]]

[[specifying-an-endpoint-configurator-class]]
18.10 Specifying an Endpoint Configurator Class
-----------------------------------------------

The Java API for WebSocket enables you to configure how the container
creates server endpoint instances. You can provide custom endpoint
configuration logic to:

* Access the details of the initial HTTP request for a WebSocket
connection
* Perform custom checks on the `Origin` HTTP header
* Modify the WebSocket handshake response
* Choose a WebSocket subprotocol from those requested by the client
* Control the instantiation and initialization of endpoint instances

To provide custom endpoint configuration logic, you extend the
`ServerEndpointConfig.Configurator` class and override some of its
methods. In the endpoint class, you specify the configurator class using
the `configurator` parameter of the `ServerEndpoint` annotation.

For example, the following configurator class makes the handshake
request object available to endpoint instances:

[source,oac_no_warn]
----
public class CustomConfigurator extends ServerEndpointConfig.Configurator {

    @Override
    public void modifyHandshake(ServerEndpointConfig conf,
                                HandshakeRequest req,
                                HandshakeResponse resp) {

        conf.getUserProperties().put("handshakereq", req);
    }

}
----

The following endpoint class configures endpoint instances with the
custom configurator, which enables them to access the handshake request
object:

[source,oac_no_warn]
----
@ServerEndpoint(
    value = "/myendpoint",
    configurator = CustomConfigurator.class
)
public class MyEndpoint {

    @OnOpen
    public void open(Session s, EndpointConfig conf) {
        HandshakeRequest req = (HandshakeRequest) conf.getUserProperties()
                                                      .get("handshakereq");
        Map<String,List<String>> headers = req.getHeaders();
        ...
    }
}
----

The endpoint class can use the handshake request object to access the
details of the initial HTTP request, such as its headers or the
`HttpSession` object.

For more information on endpoint configuration, see the API reference
for the `ServerEndpointConfig.Configurator` class.

'''''

[width="100%",cols="^5%,^5%,^10%,^65%,^10%,^5%",]
|====================================================================
|link:websocket009.html[image:img/leftnav.gif[Previous] +
Previous] 
|link:websocket011.html[image:img/rightnav.gif[Next] +
Next]
|
|image:img/oracle.gif[Oracle Logo]
link:cpyr.html[ +
Copyright © 2014, 2017, Oracle and/or its affiliates. All rights reserved.]
|
|link:toc.html[image:img/toc.gif[Go To Table Of
Contents] +
Contents]
|====================================================================
